<Window
    x:Class="ControlBeeWPF.Views.UserManagementView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="User Management"
    Width="1100"
    Height="700"
    mc:Ignorable="d">

    <Window.Resources>
        <SolidColorBrush x:Key="{x:Static SystemColors.WindowBrushKey}" Color="White" />
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="7*" />
            <ColumnDefinition Width="3*" />
        </Grid.ColumnDefinitions>

        <Grid.Resources>
            <Style TargetType="Border">
                <Setter Property="BorderBrush" Value="DimGray" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="Margin" Value="5" />
                <Setter Property="Padding" Value="10" />
            </Style>

            <Style TargetType="Button">
                <Setter Property="Margin" Value="20" />
                <Setter Property="Height" Value="50" />
                <Setter Property="FontSize" Value="15" />
                <Setter Property="Foreground" Value="DarkSlateGray" />
                <Setter Property="FontWeight" Value="SemiBold" />
                <Setter Property="BorderBrush" Value="Silver" />
                <Setter Property="BorderThickness" Value="2" />
                <Setter Property="Background" Value="#FFC4E3FF" />
                <Setter Property="VerticalAlignment" Value="Center" />
            </Style>

            <Style x:Key="RoundedButtonStyle" TargetType="Button">
                <Setter Property="Margin" Value="20" />
                <Setter Property="Height" Value="50" />
                <Setter Property="FontSize" Value="15" />
                <Setter Property="Foreground" Value="DarkSlateGray" />
                <Setter Property="FontWeight" Value="SemiBold" />
                <Setter Property="Cursor" Value="Hand" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border
                                x:Name="Root"
                                Padding="10,5"
                                Background="{TemplateBinding Background}"
                                BorderBrush="Silver"
                                BorderThickness="1"
                                CornerRadius="8">
                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="Root" Property="Margin" Value="0,5,0,0" />
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </Grid.Resources>

        <Border Name="UserListBorder" Grid.Column="0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <TextBlock
                    Grid.Row="0"
                    Margin="5"
                    HorizontalAlignment="Center"
                    FontSize="25"
                    FontWeight="SemiBold"
                    Foreground="DimGray"
                    Text="User Management" />
                <Rectangle
                    Grid.Row="1"
                    Height="1"
                    Margin="20"
                    Fill="#FFBDBDBD" />

                <DataGrid
                    Grid.Row="2"
                    AutoGenerateColumns="False"
                    Background="White"
                    FontSize="16"
                    HorizontalScrollBarVisibility="Auto"
                    IsReadOnly="False"
                    ItemsSource="{Binding Users}"
                    RowHeight="40"
                    SelectedItem="{Binding SelectedUser, Mode=TwoWay}"
                    SelectionMode="Single"
                    SelectionUnit="FullRow"
                    VerticalScrollBarVisibility="Auto">
                    <DataGrid.Resources>
                        <Style x:Key="EllipsisWithTooltip" TargetType="TextBlock">
                            <Setter Property="VerticalAlignment" Value="Center" />
                            <Setter Property="TextWrapping" Value="NoWrap" />
                            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                            <Setter Property="ToolTip" Value="{Binding Text, RelativeSource={RelativeSource Self}}" />
                        </Style>
                        <Style TargetType="DataGridCell">
                            <Setter Property="VerticalContentAlignment" Value="Center" />
                        </Style>
                        <Style TargetType="ScrollBar">
                            <Setter Property="Width" Value="30" />
                        </Style>
                    </DataGrid.Resources>

                    <DataGrid.Columns>
                        <DataGridTextColumn
                            Width="50"
                            Binding="{Binding Id}"
                            Header="ID"
                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <StaticResource ResourceKey="EllipsisWithTooltip" />
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn
                            Width="150"
                            Binding="{Binding UserId}"
                            Header="User ID"
                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <StaticResource ResourceKey="EllipsisWithTooltip" />
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn
                            Width="100"
                            Binding="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            Header="Name">
                            <DataGridTextColumn.ElementStyle>
                                <StaticResource ResourceKey="EllipsisWithTooltip" />
                            </DataGridTextColumn.ElementStyle>
                            <DataGridTextColumn.EditingElementStyle>
                                <Style TargetType="TextBox">
                                    <Setter Property="TextWrapping" Value="Wrap" />
                                    <Setter Property="VerticalScrollBarVisibility" Value="Auto" />
                                </Style>
                            </DataGridTextColumn.EditingElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn
                            Width="*"
                            Binding="{Binding PasswordInput, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            Header="New Password">
                            <DataGridTextColumn.ElementStyle>
                                <StaticResource ResourceKey="EllipsisWithTooltip" />
                            </DataGridTextColumn.ElementStyle>
                            <DataGridTextColumn.EditingElementStyle>
                                <Style TargetType="TextBox">
                                    <Setter Property="TextWrapping" Value="NoWrap" />
                                    <Setter Property="HorizontalScrollBarVisibility" Value="Auto" />
                                </Style>
                            </DataGridTextColumn.EditingElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn
                            Width="50"
                            Binding="{Binding Level, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            Header="Level">
                            <DataGridTextColumn.ElementStyle>
                                <StaticResource ResourceKey="EllipsisWithTooltip" />
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTextColumn
                            Width="150"
                            Binding="{Binding LevelName}"
                            Header="Level Name"
                            IsReadOnly="True">
                            <DataGridTextColumn.ElementStyle>
                                <StaticResource ResourceKey="EllipsisWithTooltip" />
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <DataGridTemplateColumn Width="50" Header="Delete">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button
                                        Height="25"
                                        Margin="0"
                                        Background="Red"
                                        Command="{Binding DataContext.DeleteCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                        CommandParameter="{Binding Id}" />
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>

                <Button
                    Grid.Row="3"
                    Width="210"
                    Height="50"
                    HorizontalAlignment="Right"
                    Background="#FFD0FFD0"
                    Command="{Binding UpdateUsersCommand}"
                    Content="Update"
                    Style="{StaticResource RoundedButtonStyle}" />
            </Grid>
        </Border>

        <Border Name="RegisterBorder" Grid.Column="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="40" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="40" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="40" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="40" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <Grid.Resources>
                    <Style TargetType="TextBlock">
                        <Setter Property="Margin" Value="5" />
                        <Setter Property="Foreground" Value="DimGray" />
                        <Setter Property="FontSize" Value="15" />
                        <Setter Property="VerticalAlignment" Value="Bottom" />
                    </Style>
                    <Style TargetType="TextBox">
                        <Setter Property="Margin" Value="5" />
                        <Setter Property="Foreground" Value="Black" />
                        <Setter Property="FontSize" Value="20" />
                    </Style>
                    <Style TargetType="ComboBox">
                        <Setter Property="Margin" Value="5" />
                        <Setter Property="Foreground" Value="Black" />
                        <Setter Property="Background" Value="White" />
                        <Setter Property="FontSize" Value="20" />
                    </Style>
                </Grid.Resources>

                <TextBlock
                    Grid.Row="0"
                    HorizontalAlignment="Center"
                    FontSize="25"
                    FontWeight="SemiBold"
                    Foreground="DimGray"
                    Text="Register" />
                <Rectangle
                    Grid.Row="1"
                    Height="1"
                    Margin="20"
                    Fill="#FFBDBDBD" />

                <TextBlock Grid.Row="2" Text="Name" />
                <TextBox
                    Name="NameText"
                    Grid.Row="3"
                    Text="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                <TextBlock Grid.Row="4" Text="ID" />
                <TextBox
                    Name="IdText"
                    Grid.Row="5"
                    Text="{Binding UserId, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                <TextBlock Grid.Row="6" Text="Password" />
                <TextBox
                    Name="PasswordText"
                    Grid.Row="7"
                    Text="{Binding Password, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                <TextBlock Grid.Row="8" Text="Level" />
                <ComboBox
                    Name="LevelComboBox"
                    Grid.Row="9"
                    DisplayMemberPath="Value"
                    IsEditable="True"
                    ItemsSource="{Binding LevelItems}"
                    SelectedValue="{Binding UserLevel, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                    SelectedValuePath="Key" />

                <Button
                    Grid.Row="10"
                    Background="#FFE5F3FF"
                    Command="{Binding RegisterCommand}"
                    Content="Register"
                    Style="{StaticResource RoundedButtonStyle}" />
            </Grid>
        </Border>
    </Grid>
</Window>
